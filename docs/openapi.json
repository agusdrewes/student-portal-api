{
  "openapi": "3.0.3",
  "info": {
    "title": "Student Portal API",
    "version": "1.1.0",
    "description": "Up-to-date OpenAPI specification for the Student Portal backend."
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Local development"
    }
  ],
  "tags": [
    { "name": "App", "description": "Root endpoints and health checks." },
    { "name": "Users", "description": "User management and course overview." },
    { "name": "Courses", "description": "Courses catalog and availability." },
    { "name": "Commissions", "description": "Commissions per course." },
    { "name": "Enrollments", "description": "Course enrollment lifecycle." },
    { "name": "Calendar", "description": "Academic calendar events." },
    { "name": "Notifications", "description": "In-app notifications." },
    { "name": "Account", "description": "Student account and transactions." },
    { "name": "Attendance", "description": "Commission attendance records." },
    { "name": "Purchases", "description": "Store purchases." },
    { "name": "AcademicHistory", "description": "Academic history records." },
    { "name": "Grades", "description": "Grade tracking." },
    { "name": "Careers", "description": "Careers and curriculum." }
  ],
  "paths": {
    "/": {
      "get": {
        "tags": ["App"],
        "summary": "API heartbeat",
        "responses": {
          "200": {
            "description": "Returns the default hello message",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": { "message": { "type": "string", "example": "Hello World!" } }
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": ["Users"],
        "summary": "List users",
        "responses": {
          "200": {
            "description": "Array of registered users",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/User" } }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Users"],
        "summary": "Create user",
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateUserDto" } } }
        },
        "responses": {
          "201": {
            "description": "Created user",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/User" }
              }
            }
          }
        }
      }
    },
    "/users/{userId}/courses": {
      "get": {
        "tags": ["Users"],
        "summary": "Courses assigned to a user",
        "parameters": [
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "responses": {
          "200": {
            "description": "User with enrolled courses",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/UserCourseOverview" }
              }
            }
          },
          "404": { "description": "User not found" }
        }
      }
    },
    "/courses": {
      "get": {
        "tags": ["Courses"],
        "summary": "List courses",
        "description": "Returns the catalog, the courses for a user career or the available ones, depending on the filters.",
        "parameters": [
          {
            "name": "userId",
            "in": "query",
            "schema": { "type": "string", "format": "uuid" },
            "description": "User identifier to scope the result. Required when status=available."
          },
          {
            "name": "status",
            "in": "query",
            "schema": { "type": "string", "enum": ["available"] },
            "description": "If set to available, returns only courses the user can enroll next."
          }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "List of courses in any supported shape",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    { "type": "array", "items": { "$ref": "#/components/schemas/CourseSummary" } },
                    { "type": "array", "items": { "$ref": "#/components/schemas/CourseForUser" } },
                    { "type": "array", "items": { "$ref": "#/components/schemas/CourseAvailability" } }
                  ]
                }
              }
            }
          },
          "400": { "description": "Missing userId when status=available" },
          "404": { "description": "No courses for the supplied filters" }
        }
      },
      "post": {
        "tags": ["Courses"],
        "summary": "Create course",
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateCourseDto" } } }
        },
        "responses": {
          "201": {
            "description": "Stored course",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/CourseDetail" }
              }
            }
          }
        }
      }
    },
    "/courses/{courseId}": {
      "get": {
        "tags": ["Courses"],
        "summary": "Retrieve a course",
        "parameters": [
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "responses": {
          "200": {
            "description": "Course detail",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CourseDetail" } } }
          },
          "400": { "description": "Invalid id" },
          "404": { "description": "Course not found" }
        }
      }
    },
    "/courses/{courseId}/commissions": {
      "get": {
        "tags": ["Commissions"],
        "summary": "Commissions for a course",
        "parameters": [
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["future", "in_progress", "past"] }, "description": "Filter by computed status" }
        ],
        "responses": {
          "200": {
            "description": "Commissions with computed status",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Commission" } }
              }
            }
          },
          "404": { "description": "Course not found" }
        }
      },
      "post": {
        "tags": ["Commissions"],
        "summary": "Create commission",
        "parameters": [
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateCommissionDto" } } }
        },
        "responses": {
          "201": {
            "description": "Stored commission",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Commission" }
              }
            }
          },
          "404": { "description": "Course not found" }
        }
      }
    },
    "/enrollments": {
      "get": {
        "tags": ["Enrollments"],
        "summary": "Enrollments for a user",
        "parameters": [
          { "name": "userId", "in": "query", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Enrollments with latest history info",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/EnrollmentListItem" } }
              }
            }
          },
          "404": { "description": "No enrollments" }
        }
      }
    },
    "/enrollments/{commissionId}": {
      "get": {
        "tags": ["Enrollments"],
        "summary": "Enrollment detail",
        "parameters": [
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "userId", "in": "query", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Enrollment detail",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/EnrollmentDetail" } } }
          },
          "404": { "description": "Enrollment not found" }
        }
      }
    },
    "/enrollments/{courseId}/commissions/{commissionId}": {
      "post": {
        "tags": ["Enrollments"],
        "summary": "Enroll in a commission",
        "parameters": [
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/EnrollmentRequest" } } }
        },
        "responses": {
          "201": {
            "description": "Enrollment and academic history created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/EnrollmentResponse" }
              }
            }
          },
          "400": { "description": "User already enrolled or no spots" },
          "403": { "description": "Missing correlatives" },
          "404": { "description": "Invalid enrollment data" }
        }
      },
      "delete": {
        "tags": ["Enrollments"],
        "summary": "Withdraw from a commission",
        "parameters": [
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/EnrollmentRequest" } } }
        },
        "responses": {
          "200": {
            "description": "Withdrawal confirmation",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/MessageResponse" }
              }
            }
          },
          "404": { "description": "Enrollment not found" }
        }
      }
    },
    "/calendar": {
      "get": {
        "tags": ["Calendar"],
        "summary": "List events",
        "parameters": [
          { "name": "from", "in": "query", "schema": { "type": "string", "format": "date-time" } },
          { "name": "to", "in": "query", "schema": { "type": "string", "format": "date-time" } },
          { "name": "eventType", "in": "query", "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Events in the given range",
            "content": {
              "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/CalendarEvent" } } }
            }
          }
        }
      },
      "post": {
        "tags": ["Calendar"],
        "summary": "Create calendar event",
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateCalendarEventDto" } } }
        },
        "responses": {
          "201": {
            "description": "Stored event",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarEvent" } } }
          }
        }
      }
    },
    "/calendar/{id}": {
      "get": {
        "tags": ["Calendar"],
        "summary": "Get event",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "responses": {
          "200": { "description": "Calendar event", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarEvent" } } } },
          "404": { "description": "Event not found" }
        }
      },
      "put": {
        "tags": ["Calendar"],
        "summary": "Update calendar event",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarEventUpdateDto" } } }
        },
        "responses": {
          "200": { "description": "Updated event", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarEvent" } } } },
          "404": { "description": "Event not found" }
        }
      },
      "patch": {
        "tags": ["Calendar"],
        "summary": "Update event status",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarStatusUpdateDto" } } }
        },
        "responses": {
          "200": { "description": "Status updated", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CalendarEvent" } } } },
          "404": { "description": "Event not found" }
        }
      }
    },
    "/calendar/user/{userId}": {
      "get": {
        "tags": ["Calendar"],
        "summary": "Events for a user",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Personal and global events", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/CalendarEvent" } } } } },
          "404": { "description": "User or events not found" }
        }
      }
    },
    "/notifications": {
      "get": {
        "tags": ["Notifications"],
        "summary": "Get notifications",
        "parameters": [
          { "name": "userId", "in": "query", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["unread", "latest"] }, "description": "Defaults to latest. Use unread for unread only." }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Notifications", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Notification" } } } } }
        }
      },
      "post": {
        "tags": ["Notifications"],
        "summary": "Create notification",
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateNotificationDto" } } }
        },
        "responses": {
          "201": { "description": "Stored notification", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Notification" } } } },
          "404": { "description": "User not found" }
        }
      }
    },
    "/notifications/{notificationId}": {
      "patch": {
        "tags": ["Notifications"],
        "summary": "Update notification",
        "parameters": [ { "name": "notificationId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/NotificationUpdateDto" } } }
        },
        "responses": {
          "200": { "description": "Updated notification", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Notification" } } } },
          "404": { "description": "Notification not found" }
        }
      }
    },
    "/account/{userId}/balance": {
      "get": {
        "tags": ["Account"],
        "summary": "Get account balance",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Balance", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AccountBalanceDto" } } } },
          "404": { "description": "Account not found" }
        }
      }
    },
    "/account/{userId}/transactions": {
      "post": {
        "tags": ["Account"],
        "summary": "Deposit funds",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DepositDto" } } }
        },
        "responses": {
          "200": { "description": "Updated balance", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AccountBalanceDto" } } } },
          "404": { "description": "User not found" }
        }
      }
    },
    "/commissions/{commissionId}/attendances": {
      "get": {
        "tags": ["Attendance"],
        "summary": "Attendance list for a commission",
        "parameters": [ { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Attendance records", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/AttendanceRecord" } } } } }
        }
      }
    },
    "/commissions/{commissionId}/attendances/{userId}": {
      "post": {
        "tags": ["Attendance"],
        "summary": "Mark attendance",
        "parameters": [
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AttendancePayload" } } }
        },
        "responses": {
          "200": { "description": "Saved record", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AttendanceRecord" } } } },
          "404": { "description": "User or commission not found" }
        }
      },
      "get": {
        "tags": ["Attendance"],
        "summary": "Attendance for a user",
        "parameters": [
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Chronological attendance", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/AttendanceRecord" } } } } }
        }
      }
    },
    "/users/{userId}/purchases": {
      "post": {
        "tags": ["Purchases"],
        "summary": "Create purchase",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreatePurchaseDto" } } }
        },
        "responses": {
          "201": { "description": "Stored purchase", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Purchase" } } } },
          "404": { "description": "User not found" }
        }
      },
      "get": {
        "tags": ["Purchases"],
        "summary": "List purchases",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Purchase history", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Purchase" } } } } },
          "404": { "description": "No purchases found" }
        }
      }
    },
    "/academic-history/{userId}": {
      "get": {
        "tags": ["AcademicHistory"],
        "summary": "Academic history",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "History entries", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/AcademicHistoryEntry" } } } } },
          "404": { "description": "History not found" }
        }
      }
    },
    "/academic-history/{userId}/courses/{courseId}": {
      "patch": {
        "tags": ["AcademicHistory"],
        "summary": "Update grade on history",
        "parameters": [
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "courseId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AcademicHistoryUpdateDto" } } }
        },
        "responses": {
          "200": { "description": "Updated record", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AcademicHistoryEntry" } } } },
          "404": { "description": "Record not found" }
        }
      }
    },
    "/grades/user/{userId}": {
      "get": {
        "tags": ["Grades"],
        "summary": "Grades by user",
        "parameters": [ { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "responses": {
          "200": { "description": "Grades", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Grade" } } } } },
          "404": { "description": "No grades" }
        }
      }
    },
    "/grades/user/{userId}/commission/{commissionId}": {
      "get": {
        "tags": ["Grades"],
        "summary": "Grade detail",
        "parameters": [
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "responses": {
          "200": { "description": "Grade info", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/GradeDetail" } } } },
          "404": { "description": "Grade not found" }
        }
      },
      "patch": {
        "tags": ["Grades"],
        "summary": "Update grade",
        "parameters": [
          { "name": "userId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } },
          { "name": "commissionId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UpdateGradeDto" } } }
        },
        "responses": {
          "200": { "description": "Updated grade", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Grade" } } } },
          "404": { "description": "Grade not found" }
        }
      }
    },
    "/careers": {
      "get": {
        "tags": ["Careers"],
        "summary": "List careers",
        "responses": {
          "200": { "description": "Careers with courses", "content": { "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Career" } } } } }
        }
      },
      "post": {
        "tags": ["Careers"],
        "summary": "Create career",
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CareerCreateDto" } } }
        },
        "responses": {
          "201": { "description": "Stored career", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Career" } } } }
        }
      }
    },
    "/careers/{careerId}": {
      "get": {
        "tags": ["Careers"],
        "summary": "Get career",
        "parameters": [ { "name": "careerId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "responses": {
          "200": { "description": "Career detail", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Career" } } } },
          "404": { "description": "Career not found" }
        }
      }
    },
    "/careers/{careerId}/courses": {
      "post": {
        "tags": ["Careers"],
        "summary": "Attach course to career",
        "parameters": [ { "name": "careerId", "in": "path", "required": true, "schema": { "type": "string", "format": "uuid" } } ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CareerCourseLinkDto" } } }
        },
        "responses": {
          "200": { "description": "Link confirmation", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/MessageResponse" } } } },
          "400": { "description": "Course already linked" },
          "404": { "description": "Career or course not found" }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CreateUserDto": {
        "type": "object",
        "properties": {
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "password": { "type": "string", "minLength": 4 }
        },
        "required": ["firstName", "lastName", "email", "password"]
      },
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "password": { "type": "string" }
        }
      },
      "UserSummary": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "email": { "type": "string", "format": "email" }
        }
      },
      "CourseEnrollmentSummary": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" }
        }
      },
      "UserCourseOverview": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "courses": { "type": "array", "items": { "$ref": "#/components/schemas/CourseEnrollmentSummary" } }
        }
      },
      "CreateCourseDto": {
        "type": "object",
        "properties": {
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "correlates": { "type": "array", "items": { "type": "string", "format": "uuid" } }
        },
        "required": ["code", "name"]
      },
      "CourseCareerSummary": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "name": { "type": "string" }
        }
      },
      "CorrelativeSummary": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "name": { "type": "string" },
          "code": { "type": "string" }
        }
      },
      "Commission": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "days": { "type": "string" },
          "startTime": { "type": "string" },
          "endTime": { "type": "string" },
          "shift": { "type": "string", "enum": ["morning", "afternoon", "night"] },
          "classRoom": { "type": "string" },
          "professorName": { "type": "string" },
          "availableSpots": { "type": "integer" },
          "totalSpots": { "type": "integer" },
          "mode": { "type": "string", "enum": ["virtual", "in person"] },
          "price": { "type": "string" },
          "startDate": { "type": "string", "format": "date" },
          "endDate": { "type": "string", "format": "date" },
          "status": { "type": "string", "enum": ["future", "in_progress", "past"], "nullable": true }
        }
      },
      "CreateCommissionDto": {
        "type": "object",
        "properties": {
          "days": { "type": "string" },
          "startTime": { "type": "string" },
          "endTime": { "type": "string" },
          "shift": { "type": "string", "enum": ["morning", "afternoon", "night"] },
          "classRoom": { "type": "string" },
          "professorName": { "type": "string" },
          "availableSpots": { "type": "integer" },
          "totalSpots": { "type": "integer" },
          "mode": { "type": "string", "enum": ["virtual", "in person"] },
          "price": { "type": "string" },
          "startDate": { "type": "string", "format": "date" },
          "endDate": { "type": "string", "format": "date" }
        },
        "required": [
          "days",
          "startTime",
          "endTime",
          "shift",
          "classRoom",
          "professorName",
          "availableSpots",
          "totalSpots",
          "mode",
          "price"
        ]
      },
      "CourseSummary": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "careers": { "type": "array", "items": { "type": "string" } },
          "totalCommissions": { "type": "integer" }
        }
      },
      "CourseForUser": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "careers": { "type": "array", "items": { "type": "string" } },
          "correlatives": { "type": "array", "items": { "$ref": "#/components/schemas/CorrelativeSummary" } }
        }
      },
      "CommissionAvailability": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "days": { "type": "string" },
          "shift": { "type": "string" },
          "mode": { "type": "string", "enum": ["virtual", "in person"] },
          "startTime": { "type": "string" },
          "endTime": { "type": "string" },
          "classRoom": { "type": "string" },
          "professorName": { "type": "string" },
          "availableSpots": { "type": "integer" },
          "totalSpots": { "type": "integer" },
          "startDate": { "type": "string", "format": "date" },
          "endDate": { "type": "string", "format": "date" }
        }
      },
      "CourseAvailability": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "correlatives": { "type": "array", "items": { "$ref": "#/components/schemas/CorrelativeSummary" } },
          "status": { "type": "string", "enum": ["available", "in_progress", "passed"] },
          "commissions": { "type": "array", "items": { "$ref": "#/components/schemas/CommissionAvailability" } }
        }
      },
      "CourseDetail": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "code": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "careers": { "type": "array", "items": { "$ref": "#/components/schemas/CourseCareerSummary" } },
          "correlatives": { "type": "array", "items": { "$ref": "#/components/schemas/CorrelativeSummary" } },
          "commissions": { "type": "array", "items": { "$ref": "#/components/schemas/Commission" } }
        }
      },
      "EnrollmentRequest": {
        "type": "object",
        "properties": {
          "userId": { "type": "string", "format": "uuid" }
        },
        "required": ["userId"]
      },
      "EnrollmentResponse": {
        "type": "object",
        "properties": {
          "message": { "type": "string" },
          "enrollment": {
            "type": "object",
            "properties": {
              "id": { "type": "string", "format": "uuid" },
              "course": { "$ref": "#/components/schemas/CourseEnrollmentSummary" },
              "commission": {
                "type": "object",
                "properties": {
                  "id": { "type": "string", "format": "uuid" },
                  "days": { "type": "string" },
                  "shift": { "type": "string" },
                  "professorName": { "type": "string" }
                }
              }
            }
          },
          "academicHistory": {
            "type": "object",
            "properties": {
              "semester": { "type": "string" },
              "year": { "type": "string" },
              "finalNote": { "type": "string", "nullable": true },
              "status": { "type": "string" }
            }
          }
        }
      },
      "EnrollmentListItem": {
        "type": "object",
        "properties": {
          "enrollmentId": { "type": "string", "format": "uuid" },
          "course": { "$ref": "#/components/schemas/CourseEnrollmentSummary" },
          "commission": {
            "type": "object",
            "properties": {
              "id": { "type": "string", "format": "uuid" },
              "professorName": { "type": "string" },
              "shift": { "type": "string" },
              "days": { "type": "string" },
              "startTime": { "type": "string" },
              "endTime": { "type": "string" },
              "classroom": { "type": "string" }
            }
          },
          "status": { "type": "string", "enum": ["in_progress", "passed", "failed"] },
          "finalNote": { "type": "string", "nullable": true }
        }
      },
      "EnrollmentDetail": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "course": { "$ref": "#/components/schemas/CourseEnrollmentSummary" },
          "commission": { "$ref": "#/components/schemas/Commission" }
        }
      },
      "CreateCalendarEventDto": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "startDateTime": { "type": "string", "format": "date-time" },
          "endDateTime": { "type": "string", "format": "date-time" },
          "eventType": { "type": "string" },
          "date": { "type": "string", "format": "date" },
          "sourceModule": { "type": "string" },
          "eventStatus": { "type": "string" },
          "createdAt": { "type": "string", "format": "date-time" },
          "updatedAt": { "type": "string", "format": "date-time" },
          "userId": { "type": "string", "format": "uuid" }
        },
        "required": ["id", "title", "startDateTime", "endDateTime"]
      },
      "CalendarEventUpdateDto": {
        "type": "object",
        "description": "Any subset of CreateCalendarEventDto fields",
        "additionalProperties": true
      },
      "CalendarStatusUpdateDto": {
        "type": "object",
        "properties": {
          "status": { "type": "string" }
        },
        "required": ["status"]
      },
      "CalendarEvent": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "startDateTime": { "type": "string", "format": "date-time" },
          "endDateTime": { "type": "string", "format": "date-time" },
          "eventType": { "type": "string" },
          "eventStatus": { "type": "string" },
          "sourceModule": { "type": "string" },
          "date": { "type": "string", "format": "date" },
          "createdAt": { "type": "string", "format": "date-time" },
          "updatedAt": { "type": "string", "format": "date-time" },
          "user": { "$ref": "#/components/schemas/UserSummary" }
        }
      },
      "CreateNotificationDto": {
        "type": "object",
        "properties": {
          "userId": { "type": "string", "format": "uuid" },
          "title": { "type": "string" },
          "message": { "type": "string" },
          "type": { "type": "string", "enum": ["sanction", "exam", "event"] }
        },
        "required": ["userId", "title", "message", "type"]
      },
      "Notification": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "user": { "$ref": "#/components/schemas/UserSummary" },
          "title": { "type": "string" },
          "message": { "type": "string" },
          "type": { "type": "string" },
          "isRead": { "type": "boolean" },
          "createdAt": { "type": "string", "format": "date-time" }
        }
      },
      "NotificationUpdateDto": {
        "type": "object",
        "properties": {
          "isRead": { "type": "boolean" }
        }
      },
      "AccountBalanceDto": {
        "type": "object",
        "properties": {
          "balance": { "type": "string", "example": "1000.00" }
        }
      },
      "DepositDto": {
        "type": "object",
        "properties": {
          "amount": { "type": "string" },
          "cardNumber": { "type": "string", "pattern": "^\\d{16}$" },
          "expiration": { "type": "string", "pattern": "^(0[1-9]|1[0-2])/(\\d{2})$" },
          "cvv": { "type": "string", "pattern": "^\\d{3,4}$" }
        },
        "required": ["amount", "cardNumber", "expiration", "cvv"]
      },
      "AttendancePayload": {
        "type": "object",
        "properties": {
          "present": { "type": "boolean" },
          "date": { "type": "string", "format": "date" }
        },
        "required": ["present"]
      },
      "AttendanceRecord": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "date": { "type": "string", "format": "date" },
          "present": { "type": "boolean" },
          "user": { "$ref": "#/components/schemas/UserSummary" },
          "createdAt": { "type": "string", "format": "date-time" }
        }
      },
      "CreatePurchaseDto": {
        "type": "object",
        "properties": {
          "product": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "description": { "type": "string" },
              "productCode": { "type": "string" },
              "subtotal": { "type": "string" },
              "quantity": { "type": "integer" }
            },
            "required": ["name", "description", "productCode", "subtotal", "quantity"]
          },
          "total": { "type": "string" }
        },
        "required": ["product", "total"]
      },
      "Purchase": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "user": { "$ref": "#/components/schemas/UserSummary" },
          "product": { "$ref": "#/components/schemas/CreatePurchaseDto/properties/product" },
          "date": { "type": "string", "format": "date-time" },
          "total": { "type": "string" }
        }
      },
      "AcademicHistoryEntry": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "course": { "$ref": "#/components/schemas/CourseEnrollmentSummary" },
          "commission": { "$ref": "#/components/schemas/Commission" },
          "semester": { "type": "string" },
          "year": { "type": "string" },
          "status": { "type": "string", "enum": ["in_progress", "passed", "failed"] },
          "finalNote": { "type": "string", "nullable": true }
        }
      },
      "AcademicHistoryUpdateDto": {
        "type": "object",
        "properties": {
          "finalNote": { "type": "string" },
          "status": { "type": "string", "enum": ["passed", "failed"] }
        },
        "required": ["finalNote", "status"]
      },
      "Grade": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "commission": { "$ref": "#/components/schemas/Commission" },
          "firstExam": { "type": "number", "nullable": true },
          "secondExam": { "type": "number", "nullable": true },
          "finalExam": { "type": "number", "nullable": true },
          "status": { "type": "string", "enum": ["in_progress", "passed", "failed"] }
        }
      },
      "GradeDetail": {
        "type": "object",
        "properties": {
          "commission": {
            "type": "object",
            "properties": {
              "id": { "type": "string", "format": "uuid" },
              "professor": { "type": "string" },
              "shift": { "type": "string" },
              "days": { "type": "string" }
            }
          },
          "firstExam": { "type": "number", "nullable": true },
          "secondExam": { "type": "number", "nullable": true },
          "finalExam": { "type": "number", "nullable": true },
          "status": { "type": "string" }
        }
      },
      "UpdateGradeDto": {
        "type": "object",
        "properties": {
          "firstExam": { "type": "number", "minimum": 0, "maximum": 10 },
          "secondExam": { "type": "number", "minimum": 0, "maximum": 10 },
          "finalExam": { "type": "number", "minimum": 0, "maximum": 10 },
          "status": { "type": "string", "enum": ["in_progress", "passed", "failed"] }
        }
      },
      "Career": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "courses": { "type": "array", "items": { "$ref": "#/components/schemas/CourseDetail" } }
        }
      },
      "CareerCreateDto": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "description": { "type": "string" }
        },
        "required": ["name"]
      },
      "CareerCourseLinkDto": {
        "type": "object",
        "properties": {
          "courseId": { "type": "string", "format": "uuid" }
        },
        "required": ["courseId"]
      },
      "MessageResponse": {
        "type": "object",
        "properties": {
          "message": { "type": "string" }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}
